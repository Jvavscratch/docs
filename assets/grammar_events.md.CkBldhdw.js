import{_ as n,c as a,o as l,ag as p}from"./chunks/framework.BkKiziiH.js";const b=JSON.parse('{"title":"事件块","description":"","frontmatter":{},"headers":[],"relativePath":"grammar/events.md","filePath":"grammar/events.md"}'),e={name:"grammar/events.md"};function o(r,s,c,t,i,E){return l(),a("div",null,[...s[0]||(s[0]=[p(`<h1 id="事件块" tabindex="-1">事件块 <a class="header-anchor" href="#事件块" aria-label="Permalink to &quot;事件块&quot;">​</a></h1><p>jvavscratch提供了与Scratch事件块对应的JavaScript API，使开发者能够创建响应用户交互和其他事件的代码。</p><h2 id="基本事件监听" tabindex="-1">基本事件监听 <a class="header-anchor" href="#基本事件监听" aria-label="Permalink to &quot;基本事件监听&quot;">​</a></h2><h3 id="当绿旗被点击" tabindex="-1">当绿旗被点击 <a class="header-anchor" href="#当绿旗被点击" aria-label="Permalink to &quot;当绿旗被点击&quot;">​</a></h3><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 当绿旗被点击时执行</span></span>
<span class="line"><span style="color:#B392F0;">whenFlag</span><span style="color:#E1E4E8;">(() </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  sprite.</span><span style="color:#B392F0;">say</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;程序开始运行！&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#B392F0;">  setupGame</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>这对应于Scratch中的「当绿旗被点击」事件块。</p><h3 id="当角色被点击" tabindex="-1">当角色被点击 <a class="header-anchor" href="#当角色被点击" aria-label="Permalink to &quot;当角色被点击&quot;">​</a></h3><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 当角色被点击时执行</span></span>
<span class="line"><span style="color:#B392F0;">whenClicked</span><span style="color:#E1E4E8;">(() </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  sprite.</span><span style="color:#B392F0;">say</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;你点击了我！&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#B392F0;">  playSound</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;clap&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>这对应于Scratch中的「当角色被点击」事件块。</p><h2 id="键盘事件" tabindex="-1">键盘事件 <a class="header-anchor" href="#键盘事件" aria-label="Permalink to &quot;键盘事件&quot;">​</a></h2><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 当按下空格键时执行</span></span>
<span class="line"><span style="color:#B392F0;">whenKeyPressed</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;space&quot;</span><span style="color:#E1E4E8;">, () </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  sprite.</span><span style="color:#B392F0;">jump</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#B392F0;">  playSound</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;jump&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 当按下方向键时执行</span></span>
<span class="line"><span style="color:#B392F0;">whenKeyPressed</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;right arrow&quot;</span><span style="color:#E1E4E8;">, () </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  sprite.</span><span style="color:#B392F0;">move</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">whenKeyPressed</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;left arrow&quot;</span><span style="color:#E1E4E8;">, () </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  sprite.</span><span style="color:#B392F0;">move</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">-</span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>可以监听各种键盘按键事件，包括方向键、字母键和功能键。</p><h2 id="广播事件" tabindex="-1">广播事件 <a class="header-anchor" href="#广播事件" aria-label="Permalink to &quot;广播事件&quot;">​</a></h2><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 广播消息</span></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#B392F0;"> triggerGameStart</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#B392F0;">  broadcast</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;game start&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  sprite.</span><span style="color:#B392F0;">say</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;游戏开始！&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 接收广播消息</span></span>
<span class="line"><span style="color:#B392F0;">whenIReceive</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;game start&quot;</span><span style="color:#E1E4E8;">, () </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#B392F0;">  startTimer</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#B392F0;">  spawnEnemies</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">whenIReceive</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;game over&quot;</span><span style="color:#E1E4E8;">, () </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#B392F0;">  stopTimer</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#B392F0;">  showScore</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>广播机制允许不同部分的代码之间进行通信，类似于Scratch中的广播积木。</p><h2 id="条件循环事件" tabindex="-1">条件循环事件 <a class="header-anchor" href="#条件循环事件" aria-label="Permalink to &quot;条件循环事件&quot;">​</a></h2><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 当条件为真时循环执行</span></span>
<span class="line"><span style="color:#B392F0;">whenCondition</span><span style="color:#E1E4E8;">(() </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> score </span><span style="color:#F97583;">&gt;</span><span style="color:#79B8FF;"> 100</span><span style="color:#E1E4E8;">, () </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  sprite.</span><span style="color:#B392F0;">say</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;恭喜，得分超过100！&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#B392F0;">  levelUp</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 重复直到条件满足</span></span>
<span class="line"><span style="color:#B392F0;">repeatUntil</span><span style="color:#E1E4E8;">(() </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> isGameOver</span><span style="color:#E1E4E8;">(), () </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#B392F0;">  updateGame</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#B392F0;">  wait</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">0.1</span><span style="color:#E1E4E8;">); </span><span style="color:#6A737D;">// 等待0.1秒</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>条件循环事件允许代码在特定条件下重复执行。</p><h2 id="自定义事件" tabindex="-1">自定义事件 <a class="header-anchor" href="#自定义事件" aria-label="Permalink to &quot;自定义事件&quot;">​</a></h2><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 定义自定义事件处理器</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> eventHandlers</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  playerScored: [],</span></span>
<span class="line"><span style="color:#E1E4E8;">  enemyDefeated: []</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 注册事件监听器</span></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#B392F0;"> onPlayerScored</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">callback</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">  eventHandlers.playerScored.</span><span style="color:#B392F0;">push</span><span style="color:#E1E4E8;">(callback);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 触发自定义事件</span></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#B392F0;"> notifyPlayerScored</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">points</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">  eventHandlers.playerScored.</span><span style="color:#B392F0;">forEach</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">callback</span><span style="color:#F97583;"> =&gt;</span><span style="color:#B392F0;"> callback</span><span style="color:#E1E4E8;">(points));</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 使用自定义事件</span></span>
<span class="line"><span style="color:#B392F0;">onPlayerScored</span><span style="color:#E1E4E8;">((</span><span style="color:#FFAB70;">points</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  sprite.</span><span style="color:#B392F0;">say</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`获得\${</span><span style="color:#E1E4E8;">points</span><span style="color:#9ECBFF;">}分！\`</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#B392F0;">  updateScore</span><span style="color:#E1E4E8;">(points);</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 在游戏中触发</span></span>
<span class="line"><span style="color:#B392F0;">notifyPlayerScored</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>可以创建自定义事件系统来处理游戏中的各种交互。</p><h2 id="注意事项" tabindex="-1">注意事项 <a class="header-anchor" href="#注意事项" aria-label="Permalink to &quot;注意事项&quot;">​</a></h2><ol><li>避免在事件处理器中放置过于复杂的逻辑</li><li>注意事件监听的生命周期，避免内存泄漏</li><li>合理使用广播事件来解耦代码</li><li>键盘事件应考虑用户体验，避免过于敏感的响应</li></ol>`,23)])])}const u=n(e,[["render",o]]);export{b as __pageData,u as default};
